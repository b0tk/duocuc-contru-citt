<!-- views/index.ejs -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Citt x Contru</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
    <div class="container">
        <h1 class="mt-5">Datos del Sensor</h1>
        <table class="table mt-3">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Desplazamiento X (mm)</th>
                    <th>Desplazamiento Y (mm)</th>
                    <th>Desplazamiento Z (mm)</th>
                    <th>Roll (°)</th>
                    <th>Pitch (°)</th>
                    <th>Timestamp</th>
                </tr>
            </thead>
            <tbody>
                <% data.forEach(row => { %>
                    <tr>
                        <td><%= row.id %></td>
                        <td><%= row.px.toFixed(2) %></td>
                        <td><%= row.py.toFixed(2) %></td>
                        <td><%= row.pz.toFixed(2) %></td>
                        <td><%= row.roll.toFixed(2) %></td>
                        <td><%= row.pitch.toFixed(2) %></td>
                        <td><%= new Date(row.timestamp).toLocaleString() %></td>
                    </tr>
                <% }) %>
            </tbody>
        </table>
    </div>


    
    <!-- esta wuea no funcina pero creo que es buena idea xd  -->




<h1>Control Arduino</h1>
  <button id="resetButton">Reiniciar Arduino</button>
  <div id="errors"></div>

  <script>
    document.getElementById('resetButton').addEventListener('click', () => {
      fetch('/notify_error', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ error: 'Reinicio solicitado' })
      });
    });

    // Mostrar errores en la página
    setInterval(() => {
      fetch('/errors')
        .then(response => response.json())
        .then(data => {
          document.getElementById('errors').innerText = data.join('\n');
        });
    }, 5000);
  </script>
</body>
</html>
